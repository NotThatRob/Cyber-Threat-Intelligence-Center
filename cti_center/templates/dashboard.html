{% extends "base.html" %}
{% block title %}Dashboard - Cyber Threat Intelligence Center{% endblock %}
{% block content %}
<nav class="tabs">
    <a href="/?tab=trending" class="tab {% if active_tab == 'trending' %}active{% endif %}">Trending</a>
    <a href="/?tab=recent" class="tab {% if active_tab == 'recent' %}active{% endif %}">Recent</a>
    <a href="/?tab=all" class="tab {% if active_tab == 'all' %}active{% endif %}">All</a>
</nav>
<table>
    <thead>
        <tr>
            <th>CVE ID</th>
            <th>Severity</th>
            <th>CVSS</th>
            <th>Product</th>
            <th>Description</th>
            <th>Published</th>
        </tr>
    </thead>
    <tbody>
        {% for cve in cves %}
        <tr class="severity-{{ cve.severity | lower }}">
            <td>
                <a href="{{ cve.source_url }}" target="_blank" rel="noopener">{{ cve.cve_id }}</a>
                {% if cve.kev_date_added %}
                <span class="badge-kev" title="CISA KEV â€” Due: {{ cve.kev_due_date }}{% if cve.kev_ransomware == 'Known' %} | Ransomware: Known{% endif %}">Actively Exploited</span>
                {% endif %}
                {% if news_counts.get(cve.cve_id) %}
                <a href="/news" class="badge-news" title="{{ news_counts[cve.cve_id] }} news article(s)">{{ news_counts[cve.cve_id] }} in news</a>
                {% endif %}
            </td>
            <td>{{ cve.severity }}</td>
            <td>{{ cve.cvss_score }}</td>
            <td>{{ cve.affected_product }}</td>
            <td>{{ cve.description }}</td>
            <td>{{ cve.date_published }}</td>
        </tr>
        {% else %}
        <tr>
            <td colspan="6" class="empty-state">No CVEs match this filter.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endblock %}
